$(document).ready(function () {
  $(".header__burger").click(function name(event) {
    $(".header__burger,.header__menu").toggleClass("burger-active");
  });
});

$(document).ready(function () {
  $(".tabs-faq__title").click(function name(event) {
    $(this)
      .toggleClass("faq-active")
      .next()
      .toggleClass("faq-active")
      .slideToggle(300);
  });
});

$(document).ready(function () {
  $(".item-faq__title").click(function name(event) {
    $(this).toggleClass("faq-active").next().slideToggle(300);
  });
});

$(document).ready(function () {
  $(".aside-courses__title").addClass("slide-active");
  $(".aside-courses__title").click(function name(event) {
    $(this).toggleClass("slide-active").next().slideToggle(300);
  });
});

function cartTabs() {
  const tabsBtns = Array.from(document.querySelectorAll(".tabs__link"));
  const tabsBlocks = Array.from(document.querySelectorAll(".tabs__item"));

  if (tabsBtns[0]) {
    tabsBtns[0].classList.add("tab-active");
    tabsBlocks[0].classList.add("tab-active");
    for (const btn of tabsBtns) {
      btn.onclick = () => {
        hideAll();
        btn.classList.add("tab-active");
        let index = tabsBtns.indexOf(btn);
        tabsBlocks[index].classList.add("tab-active");
      };
      function hideAll() {
        tabsBlocks.forEach((block) => {
          block.classList.remove("tab-active");
        });
        tabsBtns.forEach((btn) => {
          btn.classList.remove("tab-active");
        });
      }
    }
  }
}
function isWebp() {
  function testWebP(callback) {
    let webP = new Image();
    webP.onload = webP.onerror = function () {
      callback(webP.height == 2);
    };
    webP.src =
      "data:image/webp;base64,UklGRjoAAABXRUJQVlA4IC4AAACyAgCdASoCAAIALmk0mk0iIiIiIgBoSygABc6WWgAA/veff/0PP8bA//LwYAAA";
  }

  testWebP(function (support) {
    let className = support === true ? "webp" : "no-webp";
    document.documentElement.classList.add(className);
  });
}
function popup() {
  const deponingBtn = document.getElementsByClassName("deponingBtn");
  const searchBtn = document.getElementsByClassName("searchingBtn");
  const signInBtn = document.getElementsByClassName("profile");
  const timeBtn = document.getElementsByClassName("timeBtn");
  const callbackBtn = document.getElementsByClassName(
    "header-bottom__callback"
  );
  const thanksBtn = document.getElementsByClassName("callback__send");
  const closeThanksBtn = document.getElementsByClassName(
    "thanks-ordering__close"
  );
  const catalogBtn = Array.from(
    document.getElementsByClassName("header-bottom__catalog")
  );

  const deponingBLock = document.querySelector(".deponing");
  const searchBLock = document.querySelector(".search");
  const signInBLock = document.querySelector(".sign-in");
  const timeBLock = document.querySelector(".timeBlock");
  const callbackBlock = document.querySelector(".callback");
  const thanksBLock = document.querySelector(".thanks-ordering");
  const catalogBlock = document.querySelector(".catalog");
  const catalogMobileBlock = document.querySelector(".catalog__mobile");

  closeThanksBtn.onclick = () => {
    thanksBLock.classList.remove("popup-active");
  };

  catalogBtn.forEach((btn) => {
    btn.onclick = () => {
      if (btn.classList.contains("popup-active")) {
        catalogBlock.classList.remove("popup-active");
        catalogMobileBlock.classList.remove("popup-active");
        btn.classList.remove("popup-active");
      } else {
        catalogBlock.classList.add("popup-active");
        catalogMobileBlock.classList.add("popup-active");
        btn.classList.add("popup-active");
      }

      $(document).mouseup(function (e) {
        let container = $(".catalog__mobile");
        if (container.has(e.target).length === 0) {
          catalogBlock.classList.remove("popup-active");
          catalogMobileBlock.classList.remove("popup-active");
          btn.classList.remove("popup-active");
        }
      });
    };
  });

  function openPopup(btnDom, block) {
    let btnArray = Array.from(btnDom);

    btnArray.forEach((btn) => {
      btn.onclick = () => {
        const closeBtn = block.querySelector("#close");
        const wrapper = document.querySelector(".wrapper");

        block.classList.add("popup-active");
        wrapper.classList.add("popup-active");

        closeBtn.onclick = () => {
          block.classList.remove("popup-active");
          wrapper.classList.remove("popup-active");
        };
      };
    });
  }

  function hoverPopup(btnDom, block) {
    let btnArray = Array.from(btnDom);
    btnArray.forEach((btn) => {
      btn.addEventListener("mouseover", () => {
        block.classList.add("popup-active");
      });
      btn.addEventListener("mouseout", () => {
        block.classList.remove("popup-active");
      });
    });
  }
  if (deponingBtn) openPopup(deponingBtn, deponingBLock);
  if (searchBtn) openPopup(searchBtn, searchBLock);
  if (signInBtn) openPopup(signInBtn, signInBLock);
  if (callbackBtn) openPopup(callbackBtn, callbackBlock);
  if (thanksBtn) openPopup(thanksBtn, thanksBLock);
  if (timeBtn) hoverPopup(timeBtn, timeBLock);
}
function sliderIndex() {
  if (document.querySelector(".slider-reviews__container")) {
    const swiper = new Swiper(".slider-reviews__container", {
      navigation: {
        nextEl: ".swiper-button-next",
        prevEl: ".swiper-button-prev",
      },
      pagination: {
        el: ".swiper-pagination",
        clickable: true,
      },
      slidesPerView: 4,
      spaceBetween: 25,
      slidesPerGroup: 4,
    });
  }
}

cartTabs();
isWebp();
popup();
sliderIndex();
